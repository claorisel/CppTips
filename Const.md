# Const
У нас в чате проскальзывала такая картинка:
![](https://i.imgur.com/5tTgh7D.jpg)
Веcьма пугающая на первый взгляд.

## Pointer
Представим указатель как объект состоящий из двух частей — адрес в памяти и значение по этому адресу. Мы можем менять обе части, можем изменить объект на который мы указываем, а можем изменить адрес и указывать уже на другое значение в памяти.

Ок, примеры.

1. Создаем и инициализируем указатель:
```cpp
    int a = 42, b=43;

    int *ptr = &a;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;
```
Вывод:
```
Значение объекта 42
Адрес объекта 0x7ffcce6bdcc8
```
В памяти по адресу 0x7ffcce6bdcc8 хранится переменная `a`, значение этой переменной равно 42.

2. Изменяем адрес указателя:
```cpp
    ptr = &b;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;
```
Вывод:
```sh
Значение объекта 43
Адрес объекта 0x7ffcce6bdccc
```
Теперь `ptr` хранит в себе адрес (0x7ffcce6bdccc) переменной `b`, значение которой равно 43.
Мы изменили **адрес объекта**.

3. Изменяем значение объекта:
```cpp
    *ptr = 44;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;
    cout << "b = "<< b << endl;
```
Вывод:
```sh
b = 43
Значение объекта 44
Адрес объекта 0x7ffcce6bdccc
b = 44
```
Адрес памяти, на который ссылается указатель, не изменился (0x7ffcce6bdccc), но изменилось значение объекта.

Ещё раз, мы можем:
* Изменить адрес
* Изменить значение объекта по адресу

## Const 
Константность накладывает ограничения на одну из возможностей или на обе сразу.
### Константный указатель
Константный указатель запрещает нам менять адрес объекта.
Например, код ниже не скомпилируется:
```cpp
    int a = 42, b = 43;

    int  * const ptr = &a;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;

    ptr = &b;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;
```
Ошибка компиляции:
```sh
error: assignment of read-only variable ‘ptr’
```
Мы не можем изменить адрес константного указателя.
> Ключевое слов `const` справа от `*`

### Указатель на константу
Указатель на константу, соответственно, лишает нас второй возможности — изменить объект.
Следующий код не будет компилироваться:
```cpp
    int b = 43;

    int const * ptr = &b;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;

    cout << "b = "<< b << endl;

    *ptr = 44;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;
    cout << "b = "<< b << endl;
```
Ошибка компиляции:
```sh
 error: assignment of read-only location ‘* ptr’
```
Мы не можем изменить **значение объекта**. Но при этом мы можем изменить адрес, то есть мы можем просто начать указывать на другой объект.
```cpp
   int b = 43;

    int const * ptr  = &b;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;

    ptr = &a;

    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;
```
Вывод:
```sh
Значение объекта 43
Адрес объекта 0x7fffaf67dc5c
Значение объекта 42
Адрес объекта 0x7fffaf67dc58
```

> Ключевое слово `const` **слева** от *.

### Константный указатель на константу 
Запрещаем все, запрещаем менять адрес, запрещаем менять значение объекта по адресу.

Тут все просто. Создали один раз и ничего не меняем.
```cpp
    int b = 43;

    int const * const ptr = &b;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;
```
Вывод:
```sh
Значение объекта 43
Адрес объекта 0x7ffe126b1c98
```
Не скомпилируется ни один из примеров ниже:
1.
```cpp
    int b = 43;

    int const * const ptr;
    ptr = &b;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;
```
Ошибка:
```sh
error: uninitialized const ‘ptr’ [-fpermissive]
```
2.
```cpp
    int b = 43;

    int const * const ptr = &b;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;

    ptr = &a;
```
Ошибка:
```sh
error: assignment of read-only variable ‘ptr’
```
3. 
```cpp
    int b = 43;

    int const * const ptr = &b;
    cout << "Значение объекта " << *ptr << endl;
    cout << "Адрес объекта " << ptr << endl;
    
    *ptr = 44;
```
Ошибка:
```sh
error: assignment of read-only location ‘*(const int*)ptr’
```

### Итоги
У нас есть две возможности:
* Изменить адрес
* Изменить значение объекта по адресу

Запрещаем менять адрес, получаем **константный указатель**
```cpp
int  * const ptr = &a;
```
Ключевое слово `const` справа от *.

Запрещаем менять значение объекта на который указываем — **указатель на константу**.
```cpp
int const * ptr = &a;
```
Ключевое слово `const` слева от *.

Запрещаем обе возможности — **константный указатель на константную переменную**
```cpp
int const * const ptr = &a;
```
Ключевое слово `const` справа и слева от *.

Вернемся к картинке из начала поста:
![](https://i.imgur.com/5tTgh7D.jpg)

Рассматривая подобные строки кода, мысленно проводите черту по символу *.
Слева указатель на константу, справа константный указатель.
![](https://i.imgur.com/9XK5t6j.png)
